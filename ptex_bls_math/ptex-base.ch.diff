diff --git a/texk/web2c/ptexdir/ptex-base.ch b/texk/web2c/ptexdir/ptex-base.ch
index ea98f2d..43f0146 100644
--- a/texk/web2c/ptexdir/ptex-base.ch
+++ b/texk/web2c/ptexdir/ptex-base.ch
@@ -3358,10 +3358,24 @@ internal kanji code number.
 @d math_kcode_nucleus(#)==info(#+3)
 	{the |kanji character| field offset from nucleus}
 @#
-@d math_jchar=5
-@d math_text_jchar=6
+@d math_jchar=6
+@d math_text_jchar=7
 @z
 
+@x [35.681] pTeX: explicit box in math mode
+@d math_char=1 {|math_type| when the attribute is simple}
+@d sub_box=2 {|math_type| when the attribute is a box}
+@d sub_mlist=3 {|math_type| when the attribute is a formula}
+@d math_text_char=4 {|math_type| when italic correction is dubious}
+@y
+@d math_char=1 {|math_type| when the attribute is simple}
+@d sub_box=2 {|math_type| when the attribute is a box}
+@d sub_exp_box=3 {|math_type| when the attribute is an explicit created box}
+@d sub_mlist=4 {|math_type| when the attribute is a formula}
+@d math_text_char=5 {|math_type| when italic correction is dubious}
+@z
+
+
 @x [34.683] radical with japanese char
 @d left_delimiter(#)==#+4 {first delimiter field of a noad}
 @d right_delimiter(#)==#+5 {second delimiter field of a fraction noad}
@@ -3407,9 +3421,13 @@ else  begin KANJI(cx):=math_kcode_nucleus(p); print_kanji(cx);
 
 @x [34.692] l.14266 - pTeX: print_subsidiary_data
   math_char: begin print_ln; print_current_string; print_fam_and_char(p);
+    end;
+  sub_box: show_info; {recursive call}
 @y
   math_char, math_jchar: begin print_ln; print_current_string;
     print_fam_and_char(p,math_type(p));
+    end;
+  sub_box, sub_exp_box: show_info; {recursive call}
 @z
 
 @x [34.696] l.14327 - pTeX: print_fam_and_char
@@ -3419,7 +3437,7 @@ accent_noad: begin print_esc("accent");
   print_fam_and_char(accent_chr(p),math_char);
 @z
 
-@x pTeX: flush choice_node
+@x [35.698] pTeX: flush choice_node
   begin if math_type(nucleus(p))>=sub_box then
     flush_node_list(info(nucleus(p)));
   if math_type(supscr(p))>=sub_box then
@@ -3468,18 +3486,35 @@ accent_noad: begin print_esc("accent");
 @x [36.720] l.14783 - pTeX: clean_box
 function clean_box(@!p:pointer;@!s:small_number):pointer;
 @y
+function shift_sub_exp_box(@!q:pointer):pointer;
+  { We assume that |math_type(q)=sub_exp_box| }
+  var d: halfword; {displacement}
+  begin
+    if direction=dir_tate then d:=t_baseline_shift
+    else d:=y_baseline_shift;
+    if cur_style<script_style then
+      shift_amount(info(q)):=shift_amount(info(q))-d;
+    math_type(q):=sub_box;
+    shift_sub_exp_box:=info(q);
+  end;
 function clean_box(@!p:pointer;@!s:small_number;@!jc:halfword):pointer;
 @z
 
 @x [36.720] l.14790 - pTeX: clean_box
 math_char: begin cur_mlist:=new_noad; mem[nucleus(cur_mlist)]:=mem[p];
   end;
+sub_box: begin q:=info(p); goto found;
+  end;
 @y
 math_char: begin cur_mlist:=new_noad; mem[nucleus(cur_mlist)]:=mem[p];
   end;
 math_jchar: begin cur_mlist:=new_noad; mem[nucleus(cur_mlist)]:=mem[p];
   math_kcode(cur_mlist):=jc;
   end;
+sub_box: begin q:=info(p); goto found;
+  end;
+sub_exp_box: begin q:=shift_sub_exp_box(p); goto found;
+  end;
 @z
 
 @x [36.720] l.14802 - pTeX: clean_box
@@ -3765,6 +3800,13 @@ math_char, math_text_char:
 math_char, math_text_char, math_jchar, math_text_jchar:
 @z
 
+@x [36.754] pTeX:
+sub_box: p:=info(nucleus(q));
+@y
+sub_box: p:=info(nucleus(q));
+sub_exp_box: p:=shift_sub_exp_box(nucleus(q));
+@z
+
 @x [36.755] l.15475 - pTeX: convert math text to KANJI char_node
   begin delta:=char_italic(cur_f)(cur_i); p:=new_character(cur_f,qo(cur_c));
   if (math_type(nucleus(q))=math_text_char)and(space(cur_f)<>0) then
@@ -4738,6 +4780,14 @@ q:pointer;
   shift_amount(cur_box):=box_context;
 @z
 
+@x [47.1076] pTeX: sub_exp_box
+    else  begin p:=new_noad;
+      math_type(nucleus(p)):=sub_box;
+@y
+    else  begin p:=new_noad;
+      math_type(nucleus(p)):=sub_exp_box;
+@z
+
 @x [47.1078] l.21585 - pTeX: box_dir adjust
   begin append_glue; subtype(tail):=box_context-(leader_flag-a_leaders);
   leader_ptr(tail):=cur_box;
